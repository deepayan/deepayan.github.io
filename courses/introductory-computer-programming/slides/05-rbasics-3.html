---
layout: remark
title: Basic usage of R - 2
subtitle: Introductory Computer Programming
author: Deepayan Sarkar
mathjax: true
---

layout: true

# Functions

---

* Most useful things in R happen by calling functions

* Functions have one or more arguments

    * All arguments have names (available as variables inside the function)
--

	* Arguments may be compulsory or optional

	* Optional arguments usually have "default" values 
--

	* Arguments may or may not be named when the function is called
	
	* Unnamed arguments are matched by position

	* Optional arguments are usually named
	
* Functions normally also have a useful "return" value






---

* For example, linear models are fit using the function `lm()`


```r
str(lm)
```

```
function (formula, data, subset, weights, na.action, method = "qr", model = TRUE, x = FALSE, 
    y = FALSE, qr = TRUE, singular.ok = TRUE, contrasts = NULL, offset, ...)  
```

* These calls are equivalent


```r
fm1 <- lm(mpg ~ wt, mtcars, (am == 0))
fm2 <- lm(mpg ~ wt, data = mtcars, method = "qr", subset = (am == 0))
coef(fm1)
```

```
(Intercept)          wt 
  31.416055   -3.785908 
```

```r
coef(fm2)
```

```
(Intercept)          wt 
  31.416055   -3.785908 
```

* Rule: named arguments are matched by name, remaining by position

---

* The return value of `lm()` is a list

.scrollable400[


```r
str(fm2)
```

```
List of 12
 $ coefficients : Named num [1:2] 31.42 -3.79
  ..- attr(*, "names")= chr [1:2] "(Intercept)" "wt"
 $ residuals    : Named num [1:19] 2.156 0.307 -0.217 -3.6 5.061 ...
  ..- attr(*, "names")= chr [1:19] "Hornet 4 Drive" "Hornet Sportabout" "Valiant" "Duster 360" ...
 $ effects      : Named num [1:19] -74.744 -12.487 -0.614 -4 4.672 ...
  ..- attr(*, "names")= chr [1:19] "(Intercept)" "wt" "" "" ...
 $ rank         : int 2
 $ fitted.values: Named num [1:19] 19.2 18.4 18.3 17.9 19.3 ...
  ..- attr(*, "names")= chr [1:19] "Hornet 4 Drive" "Hornet Sportabout" "Valiant" "Duster 360" ...
 $ assign       : int [1:2] 0 1
 $ qr           :List of 5
  ..$ qr   : num [1:19, 1:2] -4.359 0.229 0.229 0.229 0.229 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:19] "Hornet 4 Drive" "Hornet Sportabout" "Valiant" "Duster 360" ...
  .. .. ..$ : chr [1:2] "(Intercept)" "wt"
  .. ..- attr(*, "assign")= int [1:2] 0 1
  ..$ qraux: num [1:2] 1.23 1.07
  ..$ pivot: int [1:2] 1 2
  ..$ tol  : num 1e-07
  ..$ rank : int 2
  ..- attr(*, "class")= chr "qr"
 $ df.residual  : int 17
 $ xlevels      : Named list()
 $ call         : language lm(formula = mpg ~ wt, data = mtcars, subset = (am == 0), method = "qr")
 $ terms        :Classes 'terms', 'formula'  language mpg ~ wt
  .. ..- attr(*, "variables")= language list(mpg, wt)
  .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. ..$ : chr [1:2] "mpg" "wt"
  .. .. .. ..$ : chr "wt"
  .. ..- attr(*, "term.labels")= chr "wt"
  .. ..- attr(*, "order")= int 1
  .. ..- attr(*, "intercept")= int 1
  .. ..- attr(*, "response")= int 1
  .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
  .. ..- attr(*, "predvars")= language list(mpg, wt)
  .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
  .. .. ..- attr(*, "names")= chr [1:2] "mpg" "wt"
 $ model        :'data.frame':	19 obs. of  2 variables:
  ..$ mpg: num [1:19] 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 ...
  ..$ wt : num [1:19] 3.21 3.44 3.46 3.57 3.19 ...
  ..- attr(*, "terms")=Classes 'terms', 'formula'  language mpg ~ wt
  .. .. ..- attr(*, "variables")= language list(mpg, wt)
  .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:2] "mpg" "wt"
  .. .. .. .. ..$ : chr "wt"
  .. .. ..- attr(*, "term.labels")= chr "wt"
  .. .. ..- attr(*, "order")= int 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
  .. .. ..- attr(*, "predvars")= language list(mpg, wt)
  .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
  .. .. .. ..- attr(*, "names")= chr [1:2] "mpg" "wt"
 - attr(*, "class")= chr "lm"
```

]

---

* Individual elements can be extracted using list indexing


```r
fm2$coefficients
```

```
(Intercept)          wt 
  31.416055   -3.785908 
```

```r
fm2$residuals
```

```
     Hornet 4 Drive   Hornet Sportabout             Valiant          Duster 360           Merc 240D 
        2.155637322         0.307466517        -0.216815332        -3.600365503         5.060989634 
           Merc 230            Merc 280           Merc 280C          Merc 450SE          Merc 450SL 
        3.309553333         0.807466517        -0.592533483         0.392588263         0.005379702 
        Merc 450SLC  Cadillac Fleetwood Lincoln Continental   Chrysler Imperial       Toyota Corona 
       -1.905324922        -1.140040848        -0.481292938         3.519620367        -0.583793327 
   Dodge Challenger         AMC Javelin          Camaro Z28    Pontiac Firebird 
       -2.589660880        -3.211463020        -3.578170470         2.340759068 
```

---

layout: true

# Attributes

---

* The names (derived from row names of the data) can be used as index 


```r
fm2$residuals["Chrysler Imperial"]
```

```
Chrysler Imperial 
          3.51962 
```

* The names associated with a vector can be obtained using `names()`


```r
names(fm2$residuals)
```

```
 [1] "Hornet 4 Drive"      "Hornet Sportabout"   "Valiant"             "Duster 360"         
 [5] "Merc 240D"           "Merc 230"            "Merc 280"            "Merc 280C"          
 [9] "Merc 450SE"          "Merc 450SL"          "Merc 450SLC"         "Cadillac Fleetwood" 
[13] "Lincoln Continental" "Chrysler Imperial"   "Toyota Corona"       "Dodge Challenger"   
[17] "AMC Javelin"         "Camaro Z28"          "Pontiac Firebird"   
```

---

* These names are actually stored as an _attribute_ called "names"


```r
attr(fm2$residuals, "names")
```

```
 [1] "Hornet 4 Drive"      "Hornet Sportabout"   "Valiant"             "Duster 360"         
 [5] "Merc 240D"           "Merc 230"            "Merc 280"            "Merc 280C"          
 [9] "Merc 450SE"          "Merc 450SL"          "Merc 450SLC"         "Cadillac Fleetwood" 
[13] "Lincoln Continental" "Chrysler Imperial"   "Toyota Corona"       "Dodge Challenger"   
[17] "AMC Javelin"         "Camaro Z28"          "Pontiac Firebird"   
```

* Attributes are arbitrary R objects that can be attached to any other object

* Typically used for programming convenience, normally not seen by users

* However, some attributes are "special"

---

* The "names" attribute can be extracted using the function `names()`

* `dimnames()` similarly gives row / column names for matrices and arrays


```r
dimnames(VADeaths)
```

```
[[1]]
[1] "50-54" "55-59" "60-64" "65-69" "70-74"

[[2]]
[1] "Rural Male"   "Rural Female" "Urban Male"   "Urban Female"
```

```r
attr(VADeaths, "dimnames")
```

```
[[1]]
[1] "50-54" "55-59" "60-64" "65-69" "70-74"

[[2]]
[1] "Rural Male"   "Rural Female" "Urban Male"   "Urban Female"
```

---

* For example, column names can be obtained as


```r
dimnames(VADeaths)[[2]]
```

```
[1] "Rural Male"   "Rural Female" "Urban Male"   "Urban Female"
```

* There are convenient shortcuts called `rownames()` and `colnames()`


```r
colnames(VADeaths)
```

```
[1] "Rural Male"   "Rural Female" "Urban Male"   "Urban Female"
```

---

* In fact, we can easily verify that this is what `colnames()` is doing by printing it


```r
colnames
```

```
function (x, do.NULL = TRUE, prefix = "col") 
{
    if (is.data.frame(x) && do.NULL) 
        return(names(x))
    dn <- dimnames(x)
    if (!is.null(dn[[2L]])) 
        dn[[2L]]
    else {
        nc <- NCOL(x)
        if (do.NULL) 
            NULL
        else if (nc > 0L) 
            paste0(prefix, seq_len(nc))
        else character()
    }
}
<bytecode: 0x7fbc9a7c00c8>
<environment: namespace:base>
```

* All R functions can be easily inspected in this way

---

* Another very important attribute is "class"

* For example, the return value of `lm()` has class "lm"


```r
attr(fm2, "class")
```

```
[1] "lm"
```

* The class of an object can also be obtained using the function `class()`


```r
class(fm2)
```

```
[1] "lm"
```

---

layout: true

# Class, generic functions, and methods

---

* The class of an object is fundamental to how R works

* Every object in R must have a class

* This is true even if the object does not have a class attribute


```r
class(colnames)
```

```
[1] "function"
```

```r
attr(colnames, "class")
```

```
NULL
```

```r
class(VADeaths)
```

```
[1] "matrix" "array" 
```

```r
attr(VADeaths, "class")
```

```
NULL
```

---

* The main use of the class of an object is in how _generic functions_ behave

* Generic functions are intended to perform general tasks, like

	- `print()`

	- `plot()`

	- `summary()`

* But details of what these functions should do depends on the input


---


```r
print(VADeaths) 
```

```
      Rural Male Rural Female Urban Male Urban Female
50-54       11.7          8.7       15.4          8.4
55-59       18.1         11.7       24.3         13.6
60-64       26.9         20.3       37.0         19.3
65-69       41.0         30.9       54.6         35.1
70-74       66.0         54.3       71.1         50.0
```

```r
print(fm2)
```

```

Call:
lm(formula = mpg ~ wt, data = mtcars, subset = (am == 0), method = "qr")

Coefficients:
(Intercept)           wt  
     31.416       -3.786  
```

---


```r
summary(VADeaths) 
```

```
   Rural Male     Rural Female     Urban Male     Urban Female  
 Min.   :11.70   Min.   : 8.70   Min.   :15.40   Min.   : 8.40  
 1st Qu.:18.10   1st Qu.:11.70   1st Qu.:24.30   1st Qu.:13.60  
 Median :26.90   Median :20.30   Median :37.00   Median :19.30  
 Mean   :32.74   Mean   :25.18   Mean   :40.48   Mean   :25.28  
 3rd Qu.:41.00   3rd Qu.:30.90   3rd Qu.:54.60   3rd Qu.:35.10  
 Max.   :66.00   Max.   :54.30   Max.   :71.10   Max.   :50.00  
```

---


```r
summary(fm2)
```

```

Call:
lm(formula = mpg ~ wt, data = mtcars, subset = (am == 0), method = "qr")

Residuals:
    Min      1Q  Median      3Q     Max 
-3.6004 -1.5227 -0.2168  1.4816  5.0610 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  31.4161     2.9467  10.661 6.01e-09 ***
wt           -3.7859     0.7666  -4.939 0.000125 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.528 on 17 degrees of freedom
Multiple R-squared:  0.5893,	Adjusted R-squared:  0.5651 
F-statistic: 24.39 on 1 and 17 DF,  p-value: 0.0001246
```

* This kind of customized output is achieved by _methods_

---

* Methods are specific implementations of a generic function customized to its input

* The appropriate method is chosen by looking at the _class_ of the input argument
--

* The methods available for a generic function can be obtained using the `methods()` function


```r
methods("summary")
```

```
 [1] summary.Date                   summary.POSIXct                summary.POSIXlt               
 [4] summary.aov                    summary.aovlist*               summary.aspell*               
 [7] summary.check_packages_in_dir* summary.connection             summary.data.frame            
[10] summary.default                summary.ecdf*                  summary.factor                
[13] summary.glm                    summary.infl*                  summary.lm                    
[16] summary.loess*                 summary.manova                 summary.matrix                
[19] summary.mlm*                   summary.nls*                   summary.packageStatus*        
[22] summary.ppr*                   summary.prcomp*                summary.princomp*             
[25] summary.proc_time              summary.srcfile                summary.srcref                
[28] summary.stepfun                summary.stl*                   summary.table                 
[31] summary.tukeysmooth*           summary.warnings              
see '?methods' for accessing help and source code
```


---

layout: false

# Other important features

* Getting help

* Help for generic functions and methods

* How matrices and arrays are implemented in R

<!-- 

* Homework --- read the following tutorials

	* [Introduction and Language Overview I](https://www.isid.ac.in/~deepayan/R-tutorials/labs/01_introduction_lab.pdf)

	* [Language Overview II](https://www.isid.ac.in/~deepayan/R-tutorials/labs/02_language_lab.pdf)

	* Supplementary files:
      [Gcsemv.txt](https://www.isid.ac.in/~deepayan/R-tutorials/data/Gcsemv.txt),
      [iris.xls](https://www.isid.ac.in/~deepayan/R-tutorials/data/iris.xls),

-->

class: center middle

# Questions?


